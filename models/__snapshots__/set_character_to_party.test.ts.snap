export const snapshot = {};

snapshot[`model 1`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              character: U {
                                                raw: {
                                                  from: U {
                                                    raw: {
                                                      var: "character",
                                                    },
                                                  },
                                                  select: "ref",
                                                },
                                              },
                                              error: "CHARACTER_NOT_OWNED",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            equals: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "character",
                                                      },
                                                    },
                                                    select: U {
                                                      raw: [
                                                        "data",
                                                        "user",
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  character: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "character",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                  inventory: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "updatedInventory",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                  ok: true,
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                spot: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        var: "spot",
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        equals: U {
                                                          raw: [
                                                            U {
                                                              raw: {
                                                                var: "spot",
                                                              },
                                                            },
                                                            null,
                                                          ],
                                                        },
                                                      },
                                                    },
                                                    then: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            else: U {
                                                              raw: {
                                                                else: U {
                                                                  raw: {
                                                                    else: 5,
                                                                    if: U {
                                                                      raw: {
                                                                        equals: U {
                                                                          raw: [
                                                                            U {
                                                                              raw: {
                                                                                default: null,
                                                                                from: U {
                                                                                  raw: {
                                                                                    var: "inventory",
                                                                                  },
                                                                                },
                                                                                select: U {
                                                                                  raw: [
                                                                                    "data",
                                                                                    "party",
                                                                                    "member4",
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                            null,
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    then: 4,
                                                                  },
                                                                },
                                                                if: U {
                                                                  raw: {
                                                                    equals: U {
                                                                      raw: [
                                                                        U {
                                                                          raw: {
                                                                            default: null,
                                                                            from: U {
                                                                              raw: {
                                                                                var: "inventory",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "party",
                                                                                "member3",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                        null,
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                                then: 3,
                                                              },
                                                            },
                                                            if: U {
                                                              raw: {
                                                                equals: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        default: null,
                                                                        from: U {
                                                                          raw: {
                                                                            var: "inventory",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "party",
                                                                            "member2",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    null,
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                            then: 2,
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    default: null,
                                                                    from: U {
                                                                      raw: {
                                                                        var: "inventory",
                                                                      },
                                                                    },
                                                                    select: U {
                                                                      raw: [
                                                                        "data",
                                                                        "party",
                                                                        "member1",
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                                null,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: 1,
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member1: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        object: {
                                                          member1: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member1",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member1",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member2: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member2",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member2",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member3: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member3",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member3",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member4: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member4",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member4",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member5: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member5",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member5",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                1,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member1: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member2: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member1",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                2,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member2: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member3: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member2",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                3,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member3: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member4: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member3",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                4,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member4: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member5: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member4",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                5,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member5: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInventory: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                party: U {
                                                                  raw: {
                                                                    var: "member5",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "inventory",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        equals: U {
                                          raw: [
                                            U {
                                              raw: {
                                                var: "character",
                                              },
                                            },
                                            null,
                                          ],
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        object: {
                                          error: "CHARACTER_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    _match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "characters_instance_id",
                                          },
                                        },
                                        terms: U {
                                          raw: [
                                            U {
                                              raw: {
                                                var: "characterId",
                                              },
                                            },
                                            U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "instance",
                                                  },
                                                },
                                                select: "ref",
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    },
                                  },
                                  {
                                    character: U {
                                      raw: {
                                        else: null,
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "_match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "_match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "characterId",
                            "spot",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "set_character_to_party",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "set_character_to_party",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              character: U {
                                                raw: {
                                                  from: U {
                                                    raw: {
                                                      var: "character",
                                                    },
                                                  },
                                                  select: "ref",
                                                },
                                              },
                                              error: "CHARACTER_NOT_OWNED",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            equals: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "character",
                                                      },
                                                    },
                                                    select: U {
                                                      raw: [
                                                        "data",
                                                        "user",
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  character: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "character",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                  inventory: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "updatedInventory",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                  ok: true,
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                spot: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        var: "spot",
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        equals: U {
                                                          raw: [
                                                            U {
                                                              raw: {
                                                                var: "spot",
                                                              },
                                                            },
                                                            null,
                                                          ],
                                                        },
                                                      },
                                                    },
                                                    then: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            else: U {
                                                              raw: {
                                                                else: U {
                                                                  raw: {
                                                                    else: 5,
                                                                    if: U {
                                                                      raw: {
                                                                        equals: U {
                                                                          raw: [
                                                                            U {
                                                                              raw: {
                                                                                default: null,
                                                                                from: U {
                                                                                  raw: {
                                                                                    var: "inventory",
                                                                                  },
                                                                                },
                                                                                select: U {
                                                                                  raw: [
                                                                                    "data",
                                                                                    "party",
                                                                                    "member4",
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                            null,
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    then: 4,
                                                                  },
                                                                },
                                                                if: U {
                                                                  raw: {
                                                                    equals: U {
                                                                      raw: [
                                                                        U {
                                                                          raw: {
                                                                            default: null,
                                                                            from: U {
                                                                              raw: {
                                                                                var: "inventory",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "party",
                                                                                "member3",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                        null,
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                                then: 3,
                                                              },
                                                            },
                                                            if: U {
                                                              raw: {
                                                                equals: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        default: null,
                                                                        from: U {
                                                                          raw: {
                                                                            var: "inventory",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "party",
                                                                            "member2",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    null,
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                            then: 2,
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    default: null,
                                                                    from: U {
                                                                      raw: {
                                                                        var: "inventory",
                                                                      },
                                                                    },
                                                                    select: U {
                                                                      raw: [
                                                                        "data",
                                                                        "party",
                                                                        "member1",
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                                null,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: 1,
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member1: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        object: {
                                                          member1: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member1",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member1",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member2: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member2",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member2",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member3: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member3",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member3",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member4: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member4",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member4",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                          member5: U {
                                                            raw: {
                                                              else: U {
                                                                raw: {
                                                                  default: null,
                                                                  from: U {
                                                                    raw: {
                                                                      var: "inventory",
                                                                    },
                                                                  },
                                                                  select: U {
                                                                    raw: [
                                                                      "data",
                                                                      "party",
                                                                      "member5",
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              if: U {
                                                                raw: {
                                                                  equals: U {
                                                                    raw: [
                                                                      U {
                                                                        raw: {
                                                                          default: null,
                                                                          from: U {
                                                                            raw: {
                                                                              var: "inventory",
                                                                            },
                                                                          },
                                                                          select: U {
                                                                            raw: [
                                                                              "data",
                                                                              "party",
                                                                              "member5",
                                                                            ],
                                                                          },
                                                                        },
                                                                      },
                                                                      U {
                                                                        raw: {
                                                                          from: U {
                                                                            raw: {
                                                                              var: "character",
                                                                            },
                                                                          },
                                                                          select: "ref",
                                                                        },
                                                                      },
                                                                    ],
                                                                  },
                                                                },
                                                              },
                                                              then: null,
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                1,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member1: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member2: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member1",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                2,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member2: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member3: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member2",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                3,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member3: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member4: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member3",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                4,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member4: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                member5: U {
                                                  raw: {
                                                    merge: U {
                                                      raw: {
                                                        var: "member4",
                                                      },
                                                    },
                                                    with: U {
                                                      raw: {
                                                        else: U {
                                                          raw: {
                                                            object: {},
                                                          },
                                                        },
                                                        if: U {
                                                          raw: {
                                                            equals: U {
                                                              raw: [
                                                                U {
                                                                  raw: {
                                                                    var: "spot",
                                                                  },
                                                                },
                                                                5,
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        then: U {
                                                          raw: {
                                                            object: {
                                                              member5: U {
                                                                raw: {
                                                                  from: U {
                                                                    raw: {
                                                                      var: "character",
                                                                    },
                                                                  },
                                                                  select: "ref",
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInventory: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                party: U {
                                                                  raw: {
                                                                    var: "member5",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "inventory",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        equals: U {
                                          raw: [
                                            U {
                                              raw: {
                                                var: "character",
                                              },
                                            },
                                            null,
                                          ],
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        object: {
                                          error: "CHARACTER_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    _match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "characters_instance_id",
                                          },
                                        },
                                        terms: U {
                                          raw: [
                                            U {
                                              raw: {
                                                var: "characterId",
                                              },
                                            },
                                            U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "instance",
                                                  },
                                                },
                                                select: "ref",
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    },
                                  },
                                  {
                                    character: U {
                                      raw: {
                                        else: null,
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "_match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "_match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "characterId",
                            "spot",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "set_character_to_party",
              },
            },
          },
          update: U {
            raw: {
              function: "set_character_to_party",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 2`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    object: {
                                      inventory: U {
                                        raw: {
                                          from: U {
                                            raw: {
                                              var: "updatedInventory",
                                            },
                                          },
                                          select: "ref",
                                        },
                                      },
                                      ok: true,
                                    },
                                  },
                                },
                                let: [
                                  {
                                    party: U {
                                      raw: {
                                        object: {
                                          member1: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member1",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          1,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      1,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member2: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member2",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          2,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      2,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member3: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member3",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          3,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      3,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member4: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member4",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          4,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      4,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member5: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member5",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          5,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      5,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                  {
                                    updatedInventory: U {
                                      raw: {
                                        params: U {
                                          raw: {
                                            object: {
                                              data: U {
                                                raw: {
                                                  object: {
                                                    party: U {
                                                      raw: {
                                                        var: "party",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        update: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "inventory",
                                              },
                                            },
                                            select: "ref",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "a",
                            "b",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "swap_characters_in_party",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "swap_characters_in_party",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    object: {
                                      inventory: U {
                                        raw: {
                                          from: U {
                                            raw: {
                                              var: "updatedInventory",
                                            },
                                          },
                                          select: "ref",
                                        },
                                      },
                                      ok: true,
                                    },
                                  },
                                },
                                let: [
                                  {
                                    party: U {
                                      raw: {
                                        object: {
                                          member1: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member1",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          1,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      1,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member2: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member2",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          2,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      2,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member3: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member3",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          3,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      3,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member4: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member4",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          4,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      4,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          member5: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  else: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          "member5",
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  if: U {
                                                    raw: {
                                                      equals: U {
                                                        raw: [
                                                          5,
                                                          U {
                                                            raw: {
                                                              var: "b",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                  then: U {
                                                    raw: {
                                                      default: null,
                                                      from: U {
                                                        raw: {
                                                          var: "inventory",
                                                        },
                                                      },
                                                      select: U {
                                                        raw: [
                                                          "data",
                                                          "party",
                                                          U {
                                                            raw: {
                                                              concat: U {
                                                                raw: [
                                                                  "member",
                                                                  U {
                                                                    raw: {
                                                                      to_string: U {
                                                                        raw: {
                                                                          var: "a",
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                ],
                                                              },
                                                              separator: "",
                                                            },
                                                          },
                                                        ],
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      5,
                                                      U {
                                                        raw: {
                                                          var: "a",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                              then: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      U {
                                                        raw: {
                                                          concat: U {
                                                            raw: [
                                                              "member",
                                                              U {
                                                                raw: {
                                                                  to_string: U {
                                                                    raw: {
                                                                      var: "b",
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            ],
                                                          },
                                                          separator: "",
                                                        },
                                                      },
                                                    ],
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                  {
                                    updatedInventory: U {
                                      raw: {
                                        params: U {
                                          raw: {
                                            object: {
                                              data: U {
                                                raw: {
                                                  object: {
                                                    party: U {
                                                      raw: {
                                                        var: "party",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        update: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "inventory",
                                              },
                                            },
                                            select: "ref",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "a",
                            "b",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "swap_characters_in_party",
              },
            },
          },
          update: U {
            raw: {
              function: "swap_characters_in_party",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 3`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    object: {
                                      character: U {
                                        raw: {
                                          var: "character",
                                        },
                                      },
                                      inventory: U {
                                        raw: {
                                          from: U {
                                            raw: {
                                              var: "updatedInventory",
                                            },
                                          },
                                          select: "ref",
                                        },
                                      },
                                      ok: true,
                                    },
                                  },
                                },
                                let: [
                                  {
                                    party: U {
                                      raw: {
                                        object: {
                                          member1: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member1",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      1,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member2: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member2",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      2,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member3: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member3",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      3,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member4: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member4",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      4,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member5: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member5",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      5,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                  {
                                    character: U {
                                      raw: {
                                        default: null,
                                        from: U {
                                          raw: {
                                            var: "inventory",
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                            "party",
                                            U {
                                              raw: {
                                                concat: U {
                                                  raw: [
                                                    "member",
                                                    U {
                                                      raw: {
                                                        to_string: U {
                                                          raw: {
                                                            var: "spot",
                                                          },
                                                        },
                                                      },
                                                    },
                                                  ],
                                                },
                                                separator: "",
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    },
                                  },
                                  {
                                    updatedInventory: U {
                                      raw: {
                                        params: U {
                                          raw: {
                                            object: {
                                              data: U {
                                                raw: {
                                                  object: {
                                                    party: U {
                                                      raw: {
                                                        var: "party",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        update: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "inventory",
                                              },
                                            },
                                            select: "ref",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "spot",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "remove_character_from_party",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "remove_character_from_party",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    object: {
                                      character: U {
                                        raw: {
                                          var: "character",
                                        },
                                      },
                                      inventory: U {
                                        raw: {
                                          from: U {
                                            raw: {
                                              var: "updatedInventory",
                                            },
                                          },
                                          select: "ref",
                                        },
                                      },
                                      ok: true,
                                    },
                                  },
                                },
                                let: [
                                  {
                                    party: U {
                                      raw: {
                                        object: {
                                          member1: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member1",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      1,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member2: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member2",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      2,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member3: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member3",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      3,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member4: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member4",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      4,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                          member5: U {
                                            raw: {
                                              else: U {
                                                raw: {
                                                  default: null,
                                                  from: U {
                                                    raw: {
                                                      var: "inventory",
                                                    },
                                                  },
                                                  select: U {
                                                    raw: [
                                                      "data",
                                                      "party",
                                                      "member5",
                                                    ],
                                                  },
                                                },
                                              },
                                              if: U {
                                                raw: {
                                                  equals: U {
                                                    raw: [
                                                      U {
                                                        raw: {
                                                          var: "spot",
                                                        },
                                                      },
                                                      5,
                                                    ],
                                                  },
                                                },
                                              },
                                              then: null,
                                            },
                                          },
                                        },
                                      },
                                    },
                                  },
                                  {
                                    character: U {
                                      raw: {
                                        default: null,
                                        from: U {
                                          raw: {
                                            var: "inventory",
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                            "party",
                                            U {
                                              raw: {
                                                concat: U {
                                                  raw: [
                                                    "member",
                                                    U {
                                                      raw: {
                                                        to_string: U {
                                                          raw: {
                                                            var: "spot",
                                                          },
                                                        },
                                                      },
                                                    },
                                                  ],
                                                },
                                                separator: "",
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    },
                                  },
                                  {
                                    updatedInventory: U {
                                      raw: {
                                        params: U {
                                          raw: {
                                            object: {
                                              data: U {
                                                raw: {
                                                  object: {
                                                    party: U {
                                                      raw: {
                                                        var: "party",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        update: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "inventory",
                                              },
                                            },
                                            select: "ref",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                user: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "user",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        inventories: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "users_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "userId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                inventory: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInventory",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInventory: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "inventory",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                availablePulls: 5,
                                                                instance: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "instance",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                user: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "user",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedUser: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                inventories: U {
                                                                  raw: {
                                                                    append: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInventory",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "user",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "inventories",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "user",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "inventories_instance_user",
                                              },
                                            },
                                            terms: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "user",
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "guildId",
                            "spot",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "remove_character_from_party",
              },
            },
          },
          update: U {
            raw: {
              function: "remove_character_from_party",
            },
          },
        },
      },
    },
  },
]
`;
