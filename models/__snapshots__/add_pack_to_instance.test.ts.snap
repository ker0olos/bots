export const snapshot = {};

snapshot[`model 1`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_index: U {
            raw: {
              object: {
                name: "pack_manifest_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "manifest",
                              "id",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: true,
                values: undefined,
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              index: "pack_manifest_id",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                name: "pack_manifest_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "manifest",
                              "id",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: true,
                values: undefined,
              },
            },
          },
          update: U {
            raw: {
              index: "pack_manifest_id",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 2`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_index: U {
            raw: {
              object: {
                name: "packs_owner_user_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "owner",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: false,
                values: undefined,
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              index: "packs_owner_user_id",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                name: "packs_owner_user_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "owner",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: false,
                values: undefined,
              },
            },
          },
          update: U {
            raw: {
              index: "packs_owner_user_id",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 3`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_index: U {
            raw: {
              object: {
                name: "packs_maintainers_user_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "manifest",
                              "maintainers",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: false,
                values: undefined,
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              index: "packs_maintainers_user_id",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                name: "packs_maintainers_user_id",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "manifest",
                              "maintainers",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
                unique: false,
                values: undefined,
              },
            },
          },
          update: U {
            raw: {
              index: "packs_maintainers_user_id",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 4`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_index: U {
            raw: {
              object: {
                name: "packs_sorted_by_server_amount",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: undefined,
                unique: false,
                values: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "servers",
                            ],
                          },
                          reverse: true,
                        },
                      },
                    },
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "ref",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              index: "packs_sorted_by_server_amount",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                name: "packs_sorted_by_server_amount",
                source: U {
                  raw: {
                    collection: "pack",
                  },
                },
                terms: undefined,
                unique: false,
                values: U {
                  raw: [
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "data",
                              "servers",
                            ],
                          },
                          reverse: true,
                        },
                      },
                    },
                    U {
                      raw: {
                        object: {
                          field: U {
                            raw: [
                              "ref",
                            ],
                          },
                        },
                      },
                    },
                  ],
                },
              },
            },
          },
          update: U {
            raw: {
              index: "packs_sorted_by_server_amount",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 5`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                else: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        object: {
                                          ok: true,
                                          pack: U {
                                            raw: {
                                              from: U {
                                                raw: {
                                                  var: "createdPack",
                                                },
                                              },
                                              select: "ref",
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        createdPack: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "pack",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        added: U {
                                                          raw: {
                                                            now: null,
                                                          },
                                                        },
                                                        manifest: U {
                                                          raw: {
                                                            var: "manifest",
                                                          },
                                                        },
                                                        owner: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        servers: 0,
                                                        updated: U {
                                                          raw: {
                                                            now: null,
                                                          },
                                                        },
                                                        version: 1,
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                                if: U {
                                  raw: {
                                    is_nonempty: U {
                                      raw: {
                                        var: "match",
                                      },
                                    },
                                  },
                                },
                                then: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              error: "PERMISSION_DENIED",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            or: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "pack",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "owner",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "userId",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        default: U {
                                                          raw: [],
                                                        },
                                                        from: U {
                                                          raw: {
                                                            var: "pack",
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "manifest",
                                                            "maintainers",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  ok: true,
                                                  pack: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "updatedPack",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                updatedPack: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                manifest: U {
                                                                  raw: {
                                                                    var: "manifest",
                                                                  },
                                                                },
                                                                updated: U {
                                                                  raw: {
                                                                    now: null,
                                                                  },
                                                                },
                                                                version: U {
                                                                  raw: {
                                                                    add: U {
                                                                      raw: [
                                                                        U {
                                                                          raw: {
                                                                            from: U {
                                                                              raw: {
                                                                                var: "pack",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "version",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                        1,
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "pack",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        pack: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                            let: [
                              {
                                match: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "pack_manifest_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        from: U {
                                          raw: {
                                            var: "manifest",
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "id",
                                          ],
                                        },
                                      },
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "manifest",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "publish_pack",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "publish_pack",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                else: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        object: {
                                          ok: true,
                                          pack: U {
                                            raw: {
                                              from: U {
                                                raw: {
                                                  var: "createdPack",
                                                },
                                              },
                                              select: "ref",
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        createdPack: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "pack",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        added: U {
                                                          raw: {
                                                            now: null,
                                                          },
                                                        },
                                                        manifest: U {
                                                          raw: {
                                                            var: "manifest",
                                                          },
                                                        },
                                                        owner: U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        servers: 0,
                                                        updated: U {
                                                          raw: {
                                                            now: null,
                                                          },
                                                        },
                                                        version: 1,
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                                if: U {
                                  raw: {
                                    is_nonempty: U {
                                      raw: {
                                        var: "match",
                                      },
                                    },
                                  },
                                },
                                then: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              error: "PERMISSION_DENIED",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            or: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "pack",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "owner",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "userId",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        default: U {
                                                          raw: [],
                                                        },
                                                        from: U {
                                                          raw: {
                                                            var: "pack",
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "manifest",
                                                            "maintainers",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  ok: true,
                                                  pack: U {
                                                    raw: {
                                                      from: U {
                                                        raw: {
                                                          var: "updatedPack",
                                                        },
                                                      },
                                                      select: "ref",
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                updatedPack: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                manifest: U {
                                                                  raw: {
                                                                    var: "manifest",
                                                                  },
                                                                },
                                                                updated: U {
                                                                  raw: {
                                                                    now: null,
                                                                  },
                                                                },
                                                                version: U {
                                                                  raw: {
                                                                    add: U {
                                                                      raw: [
                                                                        U {
                                                                          raw: {
                                                                            from: U {
                                                                              raw: {
                                                                                var: "pack",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "version",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                        1,
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "pack",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        pack: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                            let: [
                              {
                                match: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "pack_manifest_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        from: U {
                                          raw: {
                                            var: "manifest",
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "id",
                                          ],
                                        },
                                      },
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "userId",
                            "manifest",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "publish_pack",
              },
            },
          },
          update: U {
            raw: {
              function: "publish_pack",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 6`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                collection: U {
                                  raw: {
                                    collection: U {
                                      raw: {
                                        default: U {
                                          raw: [],
                                        },
                                        from: U {
                                          raw: {
                                            after: undefined,
                                            before: undefined,
                                            paginate: U {
                                              raw: {
                                                var: "maintainer",
                                              },
                                            },
                                            size: undefined,
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                          ],
                                        },
                                      },
                                    },
                                    map: U {
                                      raw: {
                                        expr: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "refOrMatch",
                                              },
                                            },
                                          },
                                        },
                                        lambda: "refOrMatch",
                                      },
                                    },
                                  },
                                },
                                prepend: U {
                                  raw: {
                                    collection: U {
                                      raw: {
                                        default: U {
                                          raw: [],
                                        },
                                        from: U {
                                          raw: {
                                            after: undefined,
                                            before: undefined,
                                            paginate: U {
                                              raw: {
                                                var: "owner",
                                              },
                                            },
                                            size: undefined,
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                          ],
                                        },
                                      },
                                    },
                                    map: U {
                                      raw: {
                                        expr: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "refOrMatch",
                                              },
                                            },
                                          },
                                        },
                                        lambda: "refOrMatch",
                                      },
                                    },
                                  },
                                },
                              },
                            },
                            let: [
                              {
                                owner: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_owner_user_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        var: "userId",
                                      },
                                    },
                                  },
                                },
                              },
                              {
                                maintainer: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_maintainers_user_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        var: "userId",
                                      },
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: "userId",
                      },
                    },
                  },
                },
                name: "get_packs_by_user_id",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "get_packs_by_user_id",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                collection: U {
                                  raw: {
                                    collection: U {
                                      raw: {
                                        default: U {
                                          raw: [],
                                        },
                                        from: U {
                                          raw: {
                                            after: undefined,
                                            before: undefined,
                                            paginate: U {
                                              raw: {
                                                var: "maintainer",
                                              },
                                            },
                                            size: undefined,
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                          ],
                                        },
                                      },
                                    },
                                    map: U {
                                      raw: {
                                        expr: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "refOrMatch",
                                              },
                                            },
                                          },
                                        },
                                        lambda: "refOrMatch",
                                      },
                                    },
                                  },
                                },
                                prepend: U {
                                  raw: {
                                    collection: U {
                                      raw: {
                                        default: U {
                                          raw: [],
                                        },
                                        from: U {
                                          raw: {
                                            after: undefined,
                                            before: undefined,
                                            paginate: U {
                                              raw: {
                                                var: "owner",
                                              },
                                            },
                                            size: undefined,
                                          },
                                        },
                                        select: U {
                                          raw: [
                                            "data",
                                          ],
                                        },
                                      },
                                    },
                                    map: U {
                                      raw: {
                                        expr: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "refOrMatch",
                                              },
                                            },
                                          },
                                        },
                                        lambda: "refOrMatch",
                                      },
                                    },
                                  },
                                },
                              },
                            },
                            let: [
                              {
                                owner: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_owner_user_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        var: "userId",
                                      },
                                    },
                                  },
                                },
                              },
                              {
                                maintainer: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_maintainers_user_id",
                                      },
                                    },
                                    terms: U {
                                      raw: {
                                        var: "userId",
                                      },
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: "userId",
                      },
                    },
                  },
                },
                name: "get_packs_by_user_id",
              },
            },
          },
          update: U {
            raw: {
              function: "get_packs_by_user_id",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 7`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    from: U {
                                      raw: {
                                        collection: U {
                                          raw: {
                                            var: "page",
                                          },
                                        },
                                        map: U {
                                          raw: {
                                            expr: U {
                                              raw: {
                                                get: U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "x",
                                                      },
                                                    },
                                                    select: U {
                                                      raw: [
                                                        1,
                                                      ],
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                            lambda: "x",
                                          },
                                        },
                                      },
                                    },
                                    select: U {
                                      raw: [
                                        "data",
                                      ],
                                    },
                                  },
                                },
                                let: [
                                  {
                                    page: U {
                                      raw: {
                                        after: undefined,
                                        before: undefined,
                                        paginate: U {
                                          raw: {
                                            var: "packs",
                                          },
                                        },
                                        size: 100,
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                packs: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_sorted_by_server_amount",
                                      },
                                    },
                                    terms: U {
                                      raw: [],
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [],
                        },
                      },
                    },
                  },
                },
                name: "get_most_installed_packs",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "get_most_installed_packs",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    from: U {
                                      raw: {
                                        collection: U {
                                          raw: {
                                            var: "page",
                                          },
                                        },
                                        map: U {
                                          raw: {
                                            expr: U {
                                              raw: {
                                                get: U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        var: "x",
                                                      },
                                                    },
                                                    select: U {
                                                      raw: [
                                                        1,
                                                      ],
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                            lambda: "x",
                                          },
                                        },
                                      },
                                    },
                                    select: U {
                                      raw: [
                                        "data",
                                      ],
                                    },
                                  },
                                },
                                let: [
                                  {
                                    page: U {
                                      raw: {
                                        after: undefined,
                                        before: undefined,
                                        paginate: U {
                                          raw: {
                                            var: "packs",
                                          },
                                        },
                                        size: 100,
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                packs: U {
                                  raw: {
                                    match: U {
                                      raw: {
                                        index: "packs_sorted_by_server_amount",
                                      },
                                    },
                                    terms: U {
                                      raw: [],
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [],
                        },
                      },
                    },
                  },
                },
                name: "get_most_installed_packs",
              },
            },
          },
          update: U {
            raw: {
              function: "get_most_installed_packs",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 8`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        object: {
                                          error: "PACK_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        is_nonempty: U {
                                          raw: {
                                            var: "match",
                                          },
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              error: "PACK_PRIVATE",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            or: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        false,
                                                        U {
                                                          raw: {
                                                            default: false,
                                                            from: U {
                                                              raw: {
                                                                get: U {
                                                                  raw: {
                                                                    var: "match",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "manifest",
                                                                "private",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                get: U {
                                                                  raw: {
                                                                    var: "match",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "owner",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "userId",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        default: U {
                                                          raw: [],
                                                        },
                                                        from: U {
                                                          raw: {
                                                            get: U {
                                                              raw: {
                                                                var: "match",
                                                              },
                                                            },
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "manifest",
                                                            "maintainers",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  install: U {
                                                    raw: {
                                                      var: "pack",
                                                    },
                                                  },
                                                  ok: true,
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                ref: U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        get: U {
                                                          raw: {
                                                            var: "match",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              },
                                              {
                                                pack: U {
                                                  raw: {
                                                    object: {
                                                      by: U {
                                                        raw: {
                                                          var: "userId",
                                                        },
                                                      },
                                                      ref: U {
                                                        raw: {
                                                          var: "ref",
                                                        },
                                                      },
                                                      timestamp: U {
                                                        raw: {
                                                          now: null,
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                installed: U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "ref",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        collection: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "instance",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "packs",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        map: U {
                                                          raw: {
                                                            expr: U {
                                                              raw: {
                                                                from: U {
                                                                  raw: {
                                                                    var: "pack",
                                                                  },
                                                                },
                                                                select: U {
                                                                  raw: [
                                                                    "ref",
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                            lambda: "pack",
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        params: U {
                                                          raw: {
                                                            object: {
                                                              data: U {
                                                                raw: {
                                                                  object: {
                                                                    packs: U {
                                                                      raw: {
                                                                        append: U {
                                                                          raw: {
                                                                            var: "pack",
                                                                          },
                                                                        },
                                                                        collection: U {
                                                                          raw: {
                                                                            from: U {
                                                                              raw: {
                                                                                var: "instance",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "packs",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                        update: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "instance",
                                                              },
                                                            },
                                                            select: "ref",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        var: "installed",
                                                      },
                                                    },
                                                    then: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedPack: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        params: U {
                                                          raw: {
                                                            object: {
                                                              data: U {
                                                                raw: {
                                                                  object: {
                                                                    servers: U {
                                                                      raw: {
                                                                        add: U {
                                                                          raw: [
                                                                            U {
                                                                              raw: {
                                                                                default: 0,
                                                                                from: U {
                                                                                  raw: {
                                                                                    get: U {
                                                                                      raw: {
                                                                                        var: "match",
                                                                                      },
                                                                                    },
                                                                                  },
                                                                                },
                                                                                select: U {
                                                                                  raw: [
                                                                                    "data",
                                                                                    "servers",
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                            1,
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                        update: U {
                                                          raw: {
                                                            var: "ref",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        var: "installed",
                                                      },
                                                    },
                                                    then: null,
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "pack_manifest_id",
                                          },
                                        },
                                        terms: U {
                                          raw: {
                                            var: "packId",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "guildId",
                            "userId",
                            "packId",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "add_pack_to_instance",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "add_pack_to_instance",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        object: {
                                          error: "PACK_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        is_nonempty: U {
                                          raw: {
                                            var: "match",
                                          },
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            object: {
                                              error: "PACK_PRIVATE",
                                              ok: false,
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            or: U {
                                              raw: [
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        false,
                                                        U {
                                                          raw: {
                                                            default: false,
                                                            from: U {
                                                              raw: {
                                                                get: U {
                                                                  raw: {
                                                                    var: "match",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "manifest",
                                                                "private",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    equals: U {
                                                      raw: [
                                                        U {
                                                          raw: {
                                                            var: "userId",
                                                          },
                                                        },
                                                        U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                get: U {
                                                                  raw: {
                                                                    var: "match",
                                                                  },
                                                                },
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "owner",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                      ],
                                                    },
                                                  },
                                                },
                                                U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "userId",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        default: U {
                                                          raw: [],
                                                        },
                                                        from: U {
                                                          raw: {
                                                            get: U {
                                                              raw: {
                                                                var: "match",
                                                              },
                                                            },
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "manifest",
                                                            "maintainers",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                object: {
                                                  install: U {
                                                    raw: {
                                                      var: "pack",
                                                    },
                                                  },
                                                  ok: true,
                                                },
                                              },
                                            },
                                            let: [
                                              {
                                                ref: U {
                                                  raw: {
                                                    from: U {
                                                      raw: {
                                                        get: U {
                                                          raw: {
                                                            var: "match",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    select: "ref",
                                                  },
                                                },
                                              },
                                              {
                                                pack: U {
                                                  raw: {
                                                    object: {
                                                      by: U {
                                                        raw: {
                                                          var: "userId",
                                                        },
                                                      },
                                                      ref: U {
                                                        raw: {
                                                          var: "ref",
                                                        },
                                                      },
                                                      timestamp: U {
                                                        raw: {
                                                          now: null,
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                installed: U {
                                                  raw: {
                                                    contains_value: U {
                                                      raw: {
                                                        var: "ref",
                                                      },
                                                    },
                                                    in: U {
                                                      raw: {
                                                        collection: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "instance",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "data",
                                                                "packs",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        map: U {
                                                          raw: {
                                                            expr: U {
                                                              raw: {
                                                                from: U {
                                                                  raw: {
                                                                    var: "pack",
                                                                  },
                                                                },
                                                                select: U {
                                                                  raw: [
                                                                    "ref",
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                            lambda: "pack",
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedInstance: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        params: U {
                                                          raw: {
                                                            object: {
                                                              data: U {
                                                                raw: {
                                                                  object: {
                                                                    packs: U {
                                                                      raw: {
                                                                        append: U {
                                                                          raw: {
                                                                            var: "pack",
                                                                          },
                                                                        },
                                                                        collection: U {
                                                                          raw: {
                                                                            from: U {
                                                                              raw: {
                                                                                var: "instance",
                                                                              },
                                                                            },
                                                                            select: U {
                                                                              raw: [
                                                                                "data",
                                                                                "packs",
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                        update: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "instance",
                                                              },
                                                            },
                                                            select: "ref",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        var: "installed",
                                                      },
                                                    },
                                                    then: U {
                                                      raw: {
                                                        var: "instance",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedPack: U {
                                                  raw: {
                                                    else: U {
                                                      raw: {
                                                        params: U {
                                                          raw: {
                                                            object: {
                                                              data: U {
                                                                raw: {
                                                                  object: {
                                                                    servers: U {
                                                                      raw: {
                                                                        add: U {
                                                                          raw: [
                                                                            U {
                                                                              raw: {
                                                                                default: 0,
                                                                                from: U {
                                                                                  raw: {
                                                                                    get: U {
                                                                                      raw: {
                                                                                        var: "match",
                                                                                      },
                                                                                    },
                                                                                  },
                                                                                },
                                                                                select: U {
                                                                                  raw: [
                                                                                    "data",
                                                                                    "servers",
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                            1,
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                        update: U {
                                                          raw: {
                                                            var: "ref",
                                                          },
                                                        },
                                                      },
                                                    },
                                                    if: U {
                                                      raw: {
                                                        var: "installed",
                                                      },
                                                    },
                                                    then: null,
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "pack_manifest_id",
                                          },
                                        },
                                        terms: U {
                                          raw: {
                                            var: "packId",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "guildId",
                            "userId",
                            "packId",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "add_pack_to_instance",
              },
            },
          },
          update: U {
            raw: {
              function: "add_pack_to_instance",
            },
          },
        },
      },
    },
  },
]
`;

snapshot[`model 9`] = `
[
  U {
    raw: {
      else: U {
        raw: {
          create_function: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        object: {
                                          error: "PACK_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        is_nonempty: U {
                                          raw: {
                                            var: "match",
                                          },
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        in: U {
                                          raw: {
                                            object: {
                                              ok: true,
                                              uninstall: U {
                                                raw: {
                                                  var: "match",
                                                },
                                              },
                                            },
                                          },
                                        },
                                        let: [
                                          {
                                            ref: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    get: U {
                                                      raw: {
                                                        var: "match",
                                                      },
                                                    },
                                                  },
                                                },
                                                select: "ref",
                                              },
                                            },
                                          },
                                          {
                                            installed: U {
                                              raw: {
                                                contains_value: U {
                                                  raw: {
                                                    var: "ref",
                                                  },
                                                },
                                                in: U {
                                                  raw: {
                                                    collection: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "packs",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                    map: U {
                                                      raw: {
                                                        expr: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "pack",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "ref",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        lambda: "pack",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          {
                                            updatedInstance: U {
                                              raw: {
                                                else: U {
                                                  raw: {
                                                    var: "instance",
                                                  },
                                                },
                                                if: U {
                                                  raw: {
                                                    var: "installed",
                                                  },
                                                },
                                                then: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                packs: U {
                                                                  raw: {
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "packs",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    filter: U {
                                                                      raw: {
                                                                        expr: U {
                                                                          raw: {
                                                                            not: U {
                                                                              raw: {
                                                                                equals: U {
                                                                                  raw: [
                                                                                    U {
                                                                                      raw: {
                                                                                        from: U {
                                                                                          raw: {
                                                                                            var: "pack",
                                                                                          },
                                                                                        },
                                                                                        select: U {
                                                                                          raw: [
                                                                                            "ref",
                                                                                          ],
                                                                                        },
                                                                                      },
                                                                                    },
                                                                                    U {
                                                                                      raw: {
                                                                                        var: "ref",
                                                                                      },
                                                                                    },
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                          },
                                                                        },
                                                                        lambda: "pack",
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          {
                                            updatedPack: U {
                                              raw: {
                                                else: null,
                                                if: U {
                                                  raw: {
                                                    var: "installed",
                                                  },
                                                },
                                                then: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                servers: U {
                                                                  raw: {
                                                                    max: U {
                                                                      raw: [
                                                                        0,
                                                                        U {
                                                                          raw: {
                                                                            subtract: U {
                                                                              raw: [
                                                                                U {
                                                                                  raw: {
                                                                                    default: 0,
                                                                                    from: U {
                                                                                      raw: {
                                                                                        get: U {
                                                                                          raw: {
                                                                                            var: "match",
                                                                                          },
                                                                                        },
                                                                                      },
                                                                                    },
                                                                                    select: U {
                                                                                      raw: [
                                                                                        "data",
                                                                                        "servers",
                                                                                      ],
                                                                                    },
                                                                                  },
                                                                                },
                                                                                1,
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        var: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        ],
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "pack_manifest_id",
                                          },
                                        },
                                        terms: U {
                                          raw: {
                                            var: "packId",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "guildId",
                            "packId",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "remove_pack_from_instance",
              },
            },
          },
        },
      },
      if: U {
        raw: {
          exists: U {
            raw: {
              function: "remove_pack_from_instance",
            },
          },
        },
      },
      then: U {
        raw: {
          params: U {
            raw: {
              object: {
                body: U {
                  raw: {
                    query: U {
                      raw: {
                        expr: U {
                          raw: {
                            in: U {
                              raw: {
                                in: U {
                                  raw: {
                                    else: U {
                                      raw: {
                                        object: {
                                          error: "PACK_NOT_FOUND",
                                          ok: false,
                                        },
                                      },
                                    },
                                    if: U {
                                      raw: {
                                        is_nonempty: U {
                                          raw: {
                                            var: "match",
                                          },
                                        },
                                      },
                                    },
                                    then: U {
                                      raw: {
                                        in: U {
                                          raw: {
                                            object: {
                                              ok: true,
                                              uninstall: U {
                                                raw: {
                                                  var: "match",
                                                },
                                              },
                                            },
                                          },
                                        },
                                        let: [
                                          {
                                            ref: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    get: U {
                                                      raw: {
                                                        var: "match",
                                                      },
                                                    },
                                                  },
                                                },
                                                select: "ref",
                                              },
                                            },
                                          },
                                          {
                                            installed: U {
                                              raw: {
                                                contains_value: U {
                                                  raw: {
                                                    var: "ref",
                                                  },
                                                },
                                                in: U {
                                                  raw: {
                                                    collection: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: U {
                                                          raw: [
                                                            "data",
                                                            "packs",
                                                          ],
                                                        },
                                                      },
                                                    },
                                                    map: U {
                                                      raw: {
                                                        expr: U {
                                                          raw: {
                                                            from: U {
                                                              raw: {
                                                                var: "pack",
                                                              },
                                                            },
                                                            select: U {
                                                              raw: [
                                                                "ref",
                                                              ],
                                                            },
                                                          },
                                                        },
                                                        lambda: "pack",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          {
                                            updatedInstance: U {
                                              raw: {
                                                else: U {
                                                  raw: {
                                                    var: "instance",
                                                  },
                                                },
                                                if: U {
                                                  raw: {
                                                    var: "installed",
                                                  },
                                                },
                                                then: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                packs: U {
                                                                  raw: {
                                                                    collection: U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "instance",
                                                                          },
                                                                        },
                                                                        select: U {
                                                                          raw: [
                                                                            "data",
                                                                            "packs",
                                                                          ],
                                                                        },
                                                                      },
                                                                    },
                                                                    filter: U {
                                                                      raw: {
                                                                        expr: U {
                                                                          raw: {
                                                                            not: U {
                                                                              raw: {
                                                                                equals: U {
                                                                                  raw: [
                                                                                    U {
                                                                                      raw: {
                                                                                        from: U {
                                                                                          raw: {
                                                                                            var: "pack",
                                                                                          },
                                                                                        },
                                                                                        select: U {
                                                                                          raw: [
                                                                                            "ref",
                                                                                          ],
                                                                                        },
                                                                                      },
                                                                                    },
                                                                                    U {
                                                                                      raw: {
                                                                                        var: "ref",
                                                                                      },
                                                                                    },
                                                                                  ],
                                                                                },
                                                                              },
                                                                            },
                                                                          },
                                                                        },
                                                                        lambda: "pack",
                                                                      },
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "instance",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                          {
                                            updatedPack: U {
                                              raw: {
                                                else: null,
                                                if: U {
                                                  raw: {
                                                    var: "installed",
                                                  },
                                                },
                                                then: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                servers: U {
                                                                  raw: {
                                                                    max: U {
                                                                      raw: [
                                                                        0,
                                                                        U {
                                                                          raw: {
                                                                            subtract: U {
                                                                              raw: [
                                                                                U {
                                                                                  raw: {
                                                                                    default: 0,
                                                                                    from: U {
                                                                                      raw: {
                                                                                        get: U {
                                                                                          raw: {
                                                                                            var: "match",
                                                                                          },
                                                                                        },
                                                                                      },
                                                                                    },
                                                                                    select: U {
                                                                                      raw: [
                                                                                        "data",
                                                                                        "servers",
                                                                                      ],
                                                                                    },
                                                                                  },
                                                                                },
                                                                                1,
                                                                              ],
                                                                            },
                                                                          },
                                                                        },
                                                                      ],
                                                                    },
                                                                  },
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        var: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        ],
                                      },
                                    },
                                  },
                                },
                                let: [
                                  {
                                    match: U {
                                      raw: {
                                        match: U {
                                          raw: {
                                            index: "pack_manifest_id",
                                          },
                                        },
                                        terms: U {
                                          raw: {
                                            var: "packId",
                                          },
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            let: [
                              {
                                guild: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            create: U {
                                              raw: {
                                                collection: "guild",
                                              },
                                            },
                                            params: U {
                                              raw: {
                                                object: {
                                                  data: U {
                                                    raw: {
                                                      object: {
                                                        id: U {
                                                          raw: {
                                                            var: "guildId",
                                                          },
                                                        },
                                                        instances: U {
                                                          raw: [],
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            match: U {
                                              raw: {
                                                index: "guilds_discord_id",
                                              },
                                            },
                                            terms: U {
                                              raw: {
                                                var: "guildId",
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                              {
                                instance: U {
                                  raw: {
                                    in: U {
                                      raw: {
                                        else: U {
                                          raw: {
                                            in: U {
                                              raw: {
                                                var: "createdInstance",
                                              },
                                            },
                                            let: [
                                              {
                                                createdInstance: U {
                                                  raw: {
                                                    create: U {
                                                      raw: {
                                                        collection: "instance",
                                                      },
                                                    },
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                guild: U {
                                                                  raw: {
                                                                    from: U {
                                                                      raw: {
                                                                        var: "guild",
                                                                      },
                                                                    },
                                                                    select: "ref",
                                                                  },
                                                                },
                                                                inventories: U {
                                                                  raw: [],
                                                                },
                                                                main: true,
                                                                packs: U {
                                                                  raw: [],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                              {
                                                updatedGuild: U {
                                                  raw: {
                                                    params: U {
                                                      raw: {
                                                        object: {
                                                          data: U {
                                                            raw: {
                                                              object: {
                                                                instances: U {
                                                                  raw: [
                                                                    U {
                                                                      raw: {
                                                                        from: U {
                                                                          raw: {
                                                                            var: "createdInstance",
                                                                          },
                                                                        },
                                                                        select: "ref",
                                                                      },
                                                                    },
                                                                  ],
                                                                },
                                                              },
                                                            },
                                                          },
                                                        },
                                                      },
                                                    },
                                                    update: U {
                                                      raw: {
                                                        from: U {
                                                          raw: {
                                                            var: "guild",
                                                          },
                                                        },
                                                        select: "ref",
                                                      },
                                                    },
                                                  },
                                                },
                                              },
                                            ],
                                          },
                                        },
                                        if: U {
                                          raw: {
                                            is_nonempty: U {
                                              raw: {
                                                var: "match",
                                              },
                                            },
                                          },
                                        },
                                        then: U {
                                          raw: {
                                            get: U {
                                              raw: {
                                                from: U {
                                                  raw: {
                                                    var: "match",
                                                  },
                                                },
                                                select: U {
                                                  raw: [
                                                    0,
                                                  ],
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    },
                                    let: [
                                      {
                                        match: U {
                                          raw: {
                                            from: U {
                                              raw: {
                                                var: "guild",
                                              },
                                            },
                                            select: U {
                                              raw: [
                                                "data",
                                                "instances",
                                              ],
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            ],
                          },
                        },
                        lambda: U {
                          raw: [
                            "guildId",
                            "packId",
                          ],
                        },
                      },
                    },
                  },
                },
                name: "remove_pack_from_instance",
              },
            },
          },
          update: U {
            raw: {
              function: "remove_pack_from_instance",
            },
          },
        },
      },
    },
  },
]
`;
